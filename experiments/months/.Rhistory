labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
c(betterLine(graph.s2, chosen.m ~ s2_value), geom_line())
# effect on choice
betterLine = function(data, formula) {
lg = summary(lm(formula, data))$coefficients
return(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = '#d11a02')) #+
#geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = '#d11a02', linetype = 'dashed'))
}
line.graph = summary(lm(chosen.m ~ s2_value, graph.s2))$coefficients
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
c(betterLine(graph.s2, chosen.m ~ s2_value), geom_line())
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
c(betterLine(graph.s2, chosen.m ~ s2_value), geom_abline(slope = .05, intercept = 0))
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = '#d11a02'),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = '#d11a02', linetype = 'dashed'),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = '#d11a02', linetype = 'dashed')))
# effect on choice
betterLine = function(data, formula) {
lg = summary(lm(formula, data))$coefficients
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = '#d11a02'),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = '#d11a02', linetype = 'dashed'),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = '#d11a02', linetype = 'dashed')))
}
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
betterLine = function(data, formula, color) {
lg = summary(lm(formula, data))$coefficients
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = color),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed'),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed')))
}
line.graph = summary(lm(chosen.m ~ s2_value, graph.s2))$coefficients
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value, '#105db0')
# effect on choice
betterLine = function(data, formula, color = '#105db0') {
lg = summary(lm(formula, data))$coefficients
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = color),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed'),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed')))
}
line.graph = summary(lm(chosen.m ~ s2_value, graph.s2))$coefficients
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
betterLine = function(data, formula, color = '#105db0') {
lg = summary(lm(formula, data))$coefficients
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = color, size = 1.5),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1.5),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1.5)))
}
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
betterLine = function(data, formula, color = '#105db0') {
lg = summary(lm(formula, data))$coefficients
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = color, size = 1.25),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1.25),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1.25)))
}
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .53)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .53)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, in.cs.m ~ s2_value)
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = color, size = 1.25),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1, alpha = .8),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1, alpha = .8)))
betterLine = function(data, formula, color = '#105db0') {
lg = summary(lm(formula, data))$coefficients
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = color, size = 1.25),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1, alpha = .8),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1, alpha = .8)))
}
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .53)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, in.cs.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
geom_smooth(method='lm')
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(-.1, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
geom_smooth(method='lm')
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(-.3, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
geom_smooth(method='lm')
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(-.35, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
geom_smooth(method='lm')
betterLine(graph.s2, chosen.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(-.35, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
ggplot(graph.s1.full, aes(x = s1_value, y = chosen)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen - chosen.se, ymax = chosen+chosen.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.15, .3), limits = c(.14, .3)) +
betterLine(graph.s1.full, chosen ~ s1_value)
ggplot(graph.s1.full, aes(x = s1_value, y = in.cs)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs - in.cs.se, ymax = in.cs+in.cs.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.3,.45), limits = c(.29,.48)) +
betterLine(graph.s1.full, in.cs ~ s1_value)
summary(m.checkmark1)
summary(m.checkmark2)
save.image(paste0(expt, '/analysis.RData'))
expt
rm(list=ls())
load("~/Me/Psychology/Projects/choicesets/git2/experiments/months/2/analysis.rdata")
betterLine = function(data, formula, color = '#105db0') {
lg = summary(lm(formula, data))$coefficients
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = color, size = 1.25),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1, alpha = .8),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1, alpha = .8)))
}
# effect on generation -- undichotomized
graph.s1.full = df.words.filt %>% group_by(s1_value) %>%
summarize(in.cs = mean(in.cs, na.rm = T), in.cs.se = sqrt(in.cs * (1-in.cs) / n()),
chosen = mean(chosen, na.rm = T), chosen.se = sqrt(chosen * (1-chosen) / n()))
ggplot(graph.s1.full, aes(x = s1_value, y = in.cs)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs - in.cs.se, ymax = in.cs+in.cs.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.3,.45), limits = c(.29,.48)) +
betterLine(graph.s1.full, in.cs ~ s1_value)
# stats for generation
m.cs.s1 = glmer(in.cs~s1_value+(s1_value||subject),
data = df.words.filt,
family='binomial')
summary(m.cs.s1)
summary(m.cs.s2)
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
summary(m.choice.s2)
summary(m.cs.s2)
summary(m.choice.s2)
summary(m.choice.s1)
ll1 = logLik(m.choice.s1)
BIC1 = attr(ll1, 'df') * log(length(m.choice.s1$fitted.values)) - 2 * as.numeric(ll1)
m.choice.s1.null = mlogit(chosen ~ intercept | -1, df.logit, correlation = F, halton = NA, R = 1000, tol = .001)
summary(m.choice.s1.null)
ll0 = logLik(m.choice.s1.null)
BIC0 = attr(ll0, 'df') * log(length(m.choice.s1.null$fitted.values)) - 2 * as.numeric(ll0)
BFnull = exp((BIC1 - BIC0) / 2)
BFnull
# effect on choice
ggplot(graph.s1.full, aes(x = s1_value, y = chosen)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen - chosen.se, ymax = chosen+chosen.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.15, .3), limits = c(.14, .3)) +
betterLine(graph.s1.full, chosen ~ s1_value)
# effect on choice
ggplot(graph.s1.full, aes(x = s1_value, y = chosen)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen - chosen.se, ymax = chosen+chosen.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.15, .3), limits = c(.13, .3)) +
betterLine(graph.s1.full, chosen ~ s1_value)
# effect on generation -- undichotomized
graph.s1.full = df.words.filt %>% group_by(s1_value) %>%
summarize(in.cs = mean(in.cs, na.rm = T), in.cs.se = sqrt(in.cs * (1-in.cs) / n()),
chosen = mean(chosen_noNA, na.rm = T), chosen.se = sqrt(chosen * (1-chosen) / n()))
ggplot(graph.s1.full, aes(x = s1_value, y = in.cs)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs - in.cs.se, ymax = in.cs+in.cs.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.3,.45), limits = c(.29,.48)) +
betterLine(graph.s1.full, in.cs ~ s1_value)
# effect on choice
ggplot(graph.s1.full, aes(x = s1_value, y = chosen)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen - chosen.se, ymax = chosen+chosen.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.15, .3), limits = c(.13, .3)) +
betterLine(graph.s1.full, chosen ~ s1_value)
# effect on choice
ggplot(graph.s1.full, aes(x = s1_value, y = chosen)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen - chosen.se, ymax = chosen+chosen.se), width = .2) +
xlab('') + ylab('') +
#scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
#scale_y_continuous(breaks = c(.15, .3), limits = c(.13, .3)) +
betterLine(graph.s1.full, chosen ~ s1_value)
# effect on generation -- undichotomized
graph.s1.full = df.words.filt %>% group_by(s1_value) %>%
summarize(in.cs = mean(in.cs, na.rm = T), in.cs.se = sqrt(in.cs * (1-in.cs) / n()),
chosen = mean(chosen, na.rm = T), chosen.se = sqrt(chosen * (1-chosen) / n()))
ggplot(graph.s1.full, aes(x = s1_value, y = in.cs)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs - in.cs.se, ymax = in.cs+in.cs.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.3,.45), limits = c(.29,.48)) +
betterLine(graph.s1.full, in.cs ~ s1_value)
# effect on choice
ggplot(graph.s1.full, aes(x = s1_value, y = chosen)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen - chosen.se, ymax = chosen+chosen.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.15, .3), limits = c(.13, .3)) +
betterLine(graph.s1.full, chosen ~ s1_value)
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .53)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, in.cs.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
summary(m.checkmark1)
summary(m.checkmark2)
save.image(paste0(expt, '/analysis.RData'))
rm(list=ls())
load("~/Me/Psychology/Projects/choicesets/git2/experiments/months/3/analysis.rdata")
# effect on generation -- undichotomized
graph.s1.full = df.words.filt %>% group_by(s1_value) %>%
summarize(in.cs = mean(in.cs, na.rm = T), in.cs.se = sqrt(in.cs * (1-in.cs) / n()),
chosen = mean(chosen, na.rm = T), chosen.se = sqrt(chosen * (1-chosen) / n()))
ggplot(graph.s1.full, aes(x = s1_value, y = in.cs)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs - in.cs.se, ymax = in.cs+in.cs.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.3,.45), limits = c(.29,.48)) +
betterLine(graph.s1.full, in.cs ~ s1_value)
betterLine = function(data, formula, color = '#105db0') {
lg = summary(lm(formula, data))$coefficients
return(c(geom_abline(intercept = lg[1,1], slope = lg[2,1], color = color, size = 1.25),
geom_abline(intercept = lg[1,1] - lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1, alpha = .8),
geom_abline(intercept = lg[1,1] + lg[1,2], slope = lg[2,1], color = color, linetype = 'dashed', size = 1, alpha = .8)))
}
ggplot(graph.s1.full, aes(x = s1_value, y = in.cs)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs - in.cs.se, ymax = in.cs+in.cs.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.3,.45), limits = c(.29,.48)) +
betterLine(graph.s1.full, in.cs ~ s1_value)
View(graph.s1.full)
ggplot(graph.s1.full, aes(x = s1_value, y = in.cs)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs - in.cs.se, ymax = in.cs+in.cs.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.3,.45), limits = c(.29,.51)) +
betterLine(graph.s1.full, in.cs ~ s1_value)
ggplot(graph.s1.full, aes(x = s1_value, y = in.cs)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs - in.cs.se, ymax = in.cs+in.cs.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.3,.45), limits = c(.29,.52)) +
betterLine(graph.s1.full, in.cs ~ s1_value)
# effect on choice
ggplot(graph.s1.full, aes(x = s1_value, y = chosen)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen - chosen.se, ymax = chosen+chosen.se), width = .2) +
xlab('') + ylab('') +
scale_x_continuous(breaks = c(min(graph.s1.full$s1_value), max(graph.s1.full$s1_value))) +
scale_y_continuous(breaks = c(.15, .3), limits = c(.13, .3)) +
betterLine(graph.s1.full, chosen ~ s1_value)
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .53)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, in.cs.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .54)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, in.cs.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .55)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, in.cs.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .56)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, in.cs.m ~ s2_value)
ggplot(graph.s2, aes(x = s2_value, y = in.cs.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = in.cs.m - in.cs.se, ymax = in.cs.m+in.cs.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(.2, .5), limits = c(.18, .57)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, in.cs.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(-.1, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(-.5, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .81)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
View(graph.s2)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .84)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .85)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .86)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
# effect on choice
ggplot(graph.s2, aes(x = s2_value, y = chosen.m)) +
geom_point(size = 5) + geom_line() +
geom_errorbar(aes(ymin = chosen.m - chosen.se, ymax = chosen.m+chosen.se), width = .2) +
labs(x = '', y = '')+
scale_y_continuous(breaks = c(0, .8), limits = c(0, .87)) +
scale_x_continuous(breaks = c(2, 25), limits = c(2,25)) +
betterLine(graph.s2, chosen.m ~ s2_value)
summary(m.freq)
# bayes factor in favor of null
BFnull.freq = exp((BIC(m.freq) - BIC(m.freq.null)) / 2)
BFnull.freq
ll1.freq = logLik(m.freq)
length(m.freq$fitted.values)
View(m.freq)
test = summary(m.freq)
View(test)
BIC(m.freq)
test = summary(m.choice.s1)
View(test)
BFnull.freq
summary(m.cs.s1)
BFnull
ll1 = logLik(m.choice.s1)
BIC1 = attr(ll1, 'df') * log(length(m.choice.s1$fitted.values)) - 2 * as.numeric(ll1)
m.choice.s1.null = mlogit(chosen ~ intercept | -1, df.logit, correlation = F, halton = NA, R = 1000, tol = .001)
summary(m.choice.s1.null)
ll0 = logLik(m.choice.s1.null)
BIC0 = attr(ll0, 'df') * log(length(m.choice.s1.null$fitted.values)) - 2 * as.numeric(ll0)
BFnull = exp((BIC1 - BIC0) / 2)
BFnull
summary(m.cs.s1)
summary(m.choice.s1)
summary(m.cs.s2)
summary(m.choice.s1)
BFnull
summary(m.cs.s2)
summary(m.choice.s2)
summary(m.choice.s1)
summary(m.choice.s2)
save.image(paste0(expt, '/analysis.RData'))
rm(list=ls())
